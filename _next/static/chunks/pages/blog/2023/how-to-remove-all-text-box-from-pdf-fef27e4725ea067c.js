(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[494],{1807:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/2023/how-to-remove-all-text-box-from-pdf",function(){return n(2690)}])},8109:function(e){e.exports={navIcon:"ExternalLink_navIcon__jySiY",externalIcon:"ExternalLink_externalIcon__n4ki_"}},2690:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var s=n(5893);n(7294);var r=n(7037),a=n(1304),o=n(4187);function i(){return(0,s.jsxs)(r.Z,{title:"How to remove all text box from pdf",createdAt:"2023-04-09T12:46:12.000Z",tags:"technology",children:[(0,s.jsx)("p",{children:"Recently, I needed to get a printed version of a 100-year-old book that was in the public domain. However, the pdf contained a small watermark on each page of the book. It would have looked terrible in print because the book was in Hindi and Sanskrit but the watermark was in English."}),(0,s.jsx)("p",{children:"Fortunately, the watermark was only a text frame (or text box). I could remove it one by one from each page using Libre Office Draw, but the e-book had over 400 pages. I was looking for a way to remove those text frames programmatically. I discovered two viable solutions after a long search."}),(0,s.jsx)("h3",{children:"Libre Office Draw - Macros"}),(0,s.jsxs)("p",{children:["If you are unfamiliar with bash, this may be a simpler method. You only need to run this Macro in Libre Office Draw. Thank you to the gentleman from the Libreoffice help desk who suggested"," ",(0,s.jsx)(o.Z,{href:"https://ask.libreoffice.org/t/how-to-remove-all-text-boxes-and-shapetype-trought-navigator/35721/2",text:"this macro",externalIcon:!0}),"."]}),(0,s.jsx)(a.Z,{language:"basic",children:'Sub removeAllTextShapeFromScannedDocument()\n	doc0 = ThisComponent\n	dPgs = doc0.DrawPages\n	u1   = dPgs.Count - 1\n\n	For k = 0 To u1\n	  dPg = dPgs(k)\n	  u2 = dPg.Count - 1\n\n	  For j = u2 To 0 Step -1\n	    sh = dPg(j)\n	    If sh.ShapeType = "com.sun.star.drawing.TextShape" Then dPg.remove(sh)\n	  Next j\n\n	Next k\nEnd Sub'}),(0,s.jsx)("p",{children:"But, as I previously stated, this e-book has over 400 pages, all of which are scanned images. This was simply too much for my laptop. Libre Office Draw is a heavy program itself. So I'll need something else for my case."}),(0,s.jsx)("h3",{children:"Ghost Script"}),(0,s.jsx)("p",{children:"Ghost Script is most likely included with your Linux distribution. It is a PDF interpreter. After a lengthy search on Stack Overflow, I discovered the correct question. I found the answer to my issue in that question. Here is the command:"}),(0,s.jsx)(a.Z,{language:"bash",children:"gs -o no-texts.pdf -sDEVICE=pdfwrite -dFILTERTEXT with-texts.pdf"}),(0,s.jsxs)("p",{children:["Thank you to the gentleman from Stack Overflow who asked"," ",(0,s.jsx)(o.Z,{href:"https://stackoverflow.com/q/61466712/4021724",text:"this question",externalIcon:!0}),"."]})]})}},1304:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var s=n(5893);n(7294);var r=n(4329),a=n(753);function o(e){let{language:t,children:n}=e;return(0,s.jsx)(r.Z,{language:t,style:a._4,children:n})}},4187:function(e,t,n){"use strict";var s=n(5893),r=n(7294),a=n(4184),o=n(5154),i=n(8109);let l={envelope:o.SRX,linkedin:o.ltd,github:o.hJX},c=e=>{let{children:t,className:n,href:c,text:h,icon:d,externalIcon:u}=e;return(0,s.jsxs)("a",{className:a(n),href:c,target:"_blank",children:[d&&r.createElement(l[d],{className:a("me-1",i.navIcon)}),t,h&&(0,s.jsx)("span",{className:"me-1",children:h}),u&&(0,s.jsx)(o.CkN,{className:i.externalIcon})]})};t.Z=c},7037:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var s=n(5893),r=n(7294),a=n(2962),o=n(3944),i=n(1163),l=n(3197),c=n(4217),h=n(2891),d=n(794);function u(e){let{date:t}=e;return(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:"badge bg-info me-2 p-2 text-uppercase",children:"Posted on "}),(0,s.jsx)("span",{className:"badge bg-secondary me-2 p-2",children:new Date(t).toDateString()})]})}var m=n(5154);function f(e){let{children:t,title:n,createdAt:f}=e,{push:x,asPath:p}=(0,i.useRouter)(),g=r.useRef(null),b=r.useRef(null),j=e=>{e.current&&e.current.scrollIntoView({behavior:"smooth",block:"start"})};return n=h(n),(0,s.jsxs)(d.Z,{title:n,children:[(0,s.jsx)(a.dX,{url:"https://sushantdhiman.com".concat(p),type:"BlogPosting",title:n,datePublished:f,authorName:"Sushant Dhiman"}),(0,s.jsxs)("div",{ref:b,children:[(0,s.jsx)("span",{className:"float-start",children:(0,s.jsx)(u,{date:f})}),(0,s.jsx)("span",{className:"float-end",children:(0,s.jsxs)(l.Z,{children:[(0,s.jsx)(c.Z,{onClick:()=>x("/blog"),size:"sm",variant:"primary",children:(0,s.jsx)(m.x_l,{})}),(0,s.jsx)(c.Z,{onClick:()=>j(g),size:"sm",variant:"primary",children:(0,s.jsx)(m.NWQ,{})})]})}),(0,s.jsx)("span",{className:"clearfix"})]}),(0,s.jsx)("br",{}),t,(0,s.jsx)("br",{ref:g}),(0,s.jsx)(c.Z,{onClick:()=>j(b),variant:"primary",size:"sm",children:(0,s.jsx)(m.ZTc,{})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(o.qw,{shortname:"sushantdhiman-github-io",config:{title:n}})]})}},794:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var s=n(5893);n(7294);var r=n(4184),a=n(9008),o=n(2891);function i(e){let{title:t,headTitle:n,children:i,className:l}=e;return(0,s.jsxs)("div",{className:r("my-3",l),children:[(0,s.jsx)(a,{children:(0,s.jsx)("title",{children:"".concat(o(n||t)," | Sushant Dhiman")})}),t&&(0,s.jsx)("h1",{className:"my-5 text-center text-primary",children:o(t)}),i]})}}},function(e){e.O(0,[766,753,774,888,179],function(){return e(e.s=1807)}),_N_E=e.O()}]);