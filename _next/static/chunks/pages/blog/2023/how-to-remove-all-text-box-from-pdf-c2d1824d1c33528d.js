(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[494],{1807:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/2023/how-to-remove-all-text-box-from-pdf",function(){return n(2690)}])},2690:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(5893);n(7294);var s=n(7037),a=n(1304),o=n(4187);function i(){return(0,r.jsxs)(s.Z,{title:"How to remove all text box from pdf",createdAt:"2023-04-09T12:46:12.000Z",tags:"technology",children:[(0,r.jsx)("p",{children:"Recently, I needed to get a printed version of a 100-year-old book that was in the public domain. However, the pdf contained a small watermark on each page of the book. It would have looked terrible in print because the book was in Hindi and Sanskrit but the watermark was in English."}),(0,r.jsx)("p",{children:"Fortunately, the watermark was only a text frame (or text box). I could remove it one by one from each page using Libre Office Draw, but the e-book had over 400 pages. I was looking for a way to remove those text frames programmatically. I discovered two viable solutions after a long search."}),(0,r.jsx)("h3",{children:"Libre Office Draw - Macros"}),(0,r.jsxs)("p",{children:["If you are unfamiliar with bash, this may be a simpler method. You only need to run this Macro in Libre Office Draw. Thank you to the gentleman from the Libreoffice help desk who suggested"," ",(0,r.jsx)(o.Z,{href:"https://ask.libreoffice.org/t/how-to-remove-all-text-boxes-and-shapetype-trought-navigator/35721/2",text:"this macro",externalIcon:!0}),"."]}),(0,r.jsx)(a.Z,{language:"basic",children:'Sub removeAllTextShapeFromScannedDocument()\n	doc0 = ThisComponent\n	dPgs = doc0.DrawPages\n	u1   = dPgs.Count - 1\n\n	For k = 0 To u1\n	  dPg = dPgs(k)\n	  u2 = dPg.Count - 1\n\n	  For j = u2 To 0 Step -1\n	    sh = dPg(j)\n	    If sh.ShapeType = "com.sun.star.drawing.TextShape" Then dPg.remove(sh)\n	  Next j\n\n	Next k\nEnd Sub'}),(0,r.jsx)("p",{children:"But, as I previously stated, this e-book has over 400 pages, all of which are scanned images. This was simply too much for my laptop. Libre Office Draw is a heavy program itself. So I'll need something else for my case."}),(0,r.jsx)("h3",{children:"Ghost Script"}),(0,r.jsx)("p",{children:"Ghost Script is most likely included with your Linux distribution. It is a PDF interpreter. After a lengthy search on Stack Overflow, I discovered the correct question. I found the answer to my issue in that question. Here is the command:"}),(0,r.jsx)(a.Z,{language:"bash",children:"gs -o no-texts.pdf -sDEVICE=pdfwrite -dFILTERTEXT with-texts.pdf"}),(0,r.jsxs)("p",{children:["Thank you to the gentleman from Stack Overflow who asked"," ",(0,r.jsx)(o.Z,{href:"https://stackoverflow.com/q/61466712/4021724",text:"this question",externalIcon:!0}),"."]})]})}},1304:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5893);n(7294);var s=n(4329),a=n(753);function o(e){let{language:t,children:n}=e;return(0,r.jsx)(s.Z,{language:t,style:a._4,children:n})}},7037:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(5893),s=n(7294),a=n(3944),o=n(1163),i=n(3197),c=n(4217),l=n(2891),h=n(794);function d(e){let{date:t}=e;return(0,r.jsxs)("span",{children:[(0,r.jsx)("span",{className:"badge bg-info me-2 p-2 text-uppercase",children:"Posted on "}),(0,r.jsx)("span",{className:"badge bg-secondary me-2 p-2",children:new Date(t).toDateString()})]})}var u=n(5154);function f(e){let{children:t,title:n,tags:f,createdAt:m}=e,x=s.useRef(null),p=s.useRef(null),g=e=>{e.current&&e.current.scrollIntoView({behavior:"smooth",block:"start"})};return n=l(n),(0,r.jsxs)(h.Z,{title:n,children:[(0,r.jsxs)("div",{ref:p,children:[(0,r.jsx)("span",{className:"float-start",children:(0,r.jsx)(d,{date:m})}),(0,r.jsx)("span",{className:"float-end",children:(0,r.jsxs)(i.Z,{children:[(0,r.jsx)(c.Z,{onClick:()=>o.push("/blog"),size:"sm",variant:"primary",children:(0,r.jsx)(u.x_l,{})}),(0,r.jsx)(c.Z,{onClick:()=>g(x),size:"sm",variant:"primary",children:(0,r.jsx)(u.NWQ,{})})]})}),(0,r.jsx)("span",{className:"clearfix"})]}),(0,r.jsx)("br",{}),t,(0,r.jsx)("br",{ref:x}),(0,r.jsx)(c.Z,{onClick:()=>g(p),variant:"primary",size:"sm",children:(0,r.jsx)(u.ZTc,{})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)(a.qw,{shortname:"sushantdhiman-github-io",config:{title:n}})]})}},794:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(5893);n(7294);var s=n(4184),a=n(9008),o=n(2891);function i(e){let{title:t,children:n,className:i}=e;return(0,r.jsxs)("div",{className:s("my-3",i),children:[(0,r.jsx)(a,{children:(0,r.jsx)("title",{children:"Sushant Dhiman | ".concat(o(t))})}),(0,r.jsx)("h2",{className:"my-3 text-center text-primary",children:o(t)}),n]})}}},function(e){e.O(0,[530,753,774,888,179],function(){return e(e.s=1807)}),_N_E=e.O()}]);