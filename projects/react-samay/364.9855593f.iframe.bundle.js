"use strict";(self.webpackChunkreact_samay=self.webpackChunkreact_samay||[]).push([[364],{"./src/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>src_TimePicker});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),lightFormat=__webpack_require__("./node_modules/date-fns/lightFormat.js"),raf=__webpack_require__("./node_modules/raf/index.js"),raf_default=__webpack_require__.n(raf),getHours=__webpack_require__("./node_modules/date-fns/getHours.js"),getMinutes=__webpack_require__("./node_modules/date-fns/getMinutes.js"),getSeconds=__webpack_require__("./node_modules/date-fns/getSeconds.js"),parse=__webpack_require__("./node_modules/date-fns/parse.js");function noop(){}function noopDisabled(){return[]}function scrollTo(element,to,duration){if(duration<=0)return void raf_default()((()=>{element.scrollTop=to}));const perTick=(to-element.scrollTop)/duration*10;raf_default()((()=>{element.scrollTop+=perTick,element.scrollTop!==to&&scrollTo(element,to,duration-10)}))}function formatOption(option,disabledOptions){let value=`${option}`,disabled=!1;return option<10&&(value=`0${option}`),disabledOptions.indexOf(option)>=0&&(disabled=!0),{value,disabled}}function generateOptions(length,disabledOptions,hideDisabledOptions,step=1){const arr=[];for(let value=0;value<length;value+=step)(disabledOptions.indexOf(value)<0||!hideDisabledOptions)&&arr.push(value);return arr}var focus_trap_react=__webpack_require__("./node_modules/focus-trap-react/dist/focus-trap-react.js"),set=__webpack_require__("./node_modules/date-fns/set.js");const src_Select=function Select({prefixCls,options,selectedIndex,type,label,onSelect,onKeyDown,focused}){const selectRef=(0,react.useRef)(null),listRef=(0,react.useRef)(null);(0,react.useEffect)((()=>{scrollToSelected(0)}),[]),(0,react.useEffect)((()=>{scrollToSelected(120)}),[selectedIndex]),(0,react.useEffect)((()=>{focused&&changeFocusBy(0)}),[focused]);const getOptionLabel=(0,react.useCallback)((value=>{const number=parseInt(value,10);return isNaN(number)?value.toUpperCase():number.toString()}),[]),handleSelect=(0,react.useCallback)((value=>{onSelect(type,value)}),[onSelect,type]),changeFocusBy=(0,react.useCallback)((offset=>{let index=selectedIndex+offset;index<0?index=options.length-1:index>=options.length&&(index=0);const selectedOption=options[index];if(selectedOption.disabled)return;handleSelect(selectedOption.value);const list=listRef.current;if(!list)return;list.children[index].focus()}),[options,selectedIndex,handleSelect]),scrollToSelected=(0,react.useCallback)((duration=>{let index=selectedIndex;index<0&&(index=0);const list=listRef.current;if(!list)return;const to=list.children[index].offsetTop;selectRef.current&&scrollTo(selectRef.current,to,duration)}),[selectedIndex]),handleComponentKeyDown=(0,react.useCallback)((e=>{40===e.keyCode?(changeFocusBy(1),e.preventDefault(),e.stopPropagation()):38===e.keyCode&&(changeFocusBy(-1),e.preventDefault(),e.stopPropagation()),onKeyDown(e)}),[changeFocusBy,onKeyDown]),getOptions=(0,react.useCallback)((()=>options.map(((item,index)=>{const selected=selectedIndex===index,cls=classnames_default()({[`${prefixCls}-select-option-selected`]:selected,[`${prefixCls}-select-option-disabled`]:item.disabled}),onClick=item.disabled?noop:()=>handleSelect(item.value);return(0,jsx_runtime.jsx)("li",{role:"radio",onClick,className:cls,tabIndex:0,onKeyDown:e=>{13!==e.keyCode&&32!==e.keyCode||(onClick(),e.preventDefault(),e.stopPropagation())},"aria-checked":selected,"aria-label":getOptionLabel(item.value),children:item.value},index)}))),[options,selectedIndex,prefixCls,handleSelect,getOptionLabel]);return 0===options.length?null:(0,jsx_runtime.jsx)("div",{className:`${prefixCls}-select`,onKeyDown:handleComponentKeyDown,ref:selectRef,children:(0,jsx_runtime.jsx)("ul",{role:"radiogroup","aria-label":`Select ${label}`,ref:listRef,children:getOptions()})})};const src_Combobox=function Combobox(props){const[selectFocusOn,setSelectFocusOn]=(0,react.useState)(null),onItemChange=(0,react.useCallback)(((type,itemValue)=>{const{onChange,defaultOpenValue,use12Hours,isAM,onAmPmChange}=props,value=props.value||defaultOpenValue;let hour=(0,getHours.q)(value),minute=(0,getMinutes.O)(value),second=(0,getSeconds.S)(value);if("hour"===type)hour=use12Hours?isAM?+itemValue%12:+itemValue%12+12:+itemValue;else if("minute"===type)minute=+itemValue;else if("ampm"===type){const ampm=itemValue.toUpperCase();use12Hours&&("PM"===ampm&&hour<12&&(hour=hour%12+12),"AM"===ampm&&hour>=12&&(hour-=12)),onAmPmChange(ampm)}else second=+itemValue;onChange((0,set.h)(value,{hours:hour,minutes:minute,seconds:second}))}),[props.onChange,props.defaultOpenValue,props.use12Hours,props.isAM,props.onAmPmChange,props.value]),getColumns=(0,react.useCallback)((()=>{const{showHour,showMinute,showSecond,use12Hours}=props;return[["hour",showHour],["minute",showMinute],["second",showSecond],["ampm",use12Hours]].filter((([,enabled])=>enabled)).map((([val])=>val))}),[props.showHour,props.showMinute,props.showSecond,props.use12Hours]),changeFocusTo=(0,react.useCallback)(((currentSelectType,offset)=>{const columns=getColumns();let newIndex=columns.indexOf(currentSelectType)+offset;newIndex<0?newIndex=columns.length-1:newIndex>=columns.length&&(newIndex=0);const newFocusOn=columns[newIndex];setSelectFocusOn(newFocusOn)}),[getColumns]),handleKeyDown=(0,react.useCallback)(((currentType,e)=>{39===e.keyCode?(changeFocusTo(currentType,1),e.preventDefault(),e.stopPropagation()):37===e.keyCode&&(changeFocusTo(currentType,-1),e.preventDefault(),e.stopPropagation())}),[changeFocusTo]),{prefixCls,defaultOpenValue,value:propValue}=props,value=propValue||defaultOpenValue;return(0,jsx_runtime.jsxs)("div",{className:`${prefixCls}-combobox`,children:[(hour=>{const{prefixCls,hourOptions,disabledHours,showHour,use12Hours}=props;if(!showHour)return null;const disabledOptions=disabledHours();let hourOptionsAdj,hourAdj;return use12Hours?(hourOptionsAdj=[12].concat(hourOptions.filter((h=>h<12&&h>0))),hourAdj=hour%12||12):(hourOptionsAdj=hourOptions,hourAdj=hour),(0,jsx_runtime.jsx)(src_Select,{prefixCls,options:hourOptionsAdj.map((option=>formatOption(option,disabledOptions))),selectedIndex:hourOptionsAdj.indexOf(hourAdj),type:"hour",label:"hour",onSelect:onItemChange,onKeyDown:e=>handleKeyDown("hour",e),focused:"hour"===selectFocusOn})})((0,getHours.q)(value)),(minute=>{const{prefixCls,minuteOptions,disabledMinutes,defaultOpenValue,showMinute,value:propValue}=props;if(!showMinute)return null;const value=propValue||defaultOpenValue,disabledOptions=disabledMinutes((0,getHours.q)(value));return(0,jsx_runtime.jsx)(src_Select,{prefixCls,options:minuteOptions.map((option=>formatOption(option,disabledOptions))),selectedIndex:minuteOptions.indexOf(minute),type:"minute",label:"minute",onSelect:onItemChange,onKeyDown:e=>handleKeyDown("minute",e),focused:"minute"===selectFocusOn})})((0,getMinutes.O)(value)),(second=>{const{prefixCls,secondOptions,disabledSeconds,showSecond,defaultOpenValue,value:propValue}=props;if(!showSecond)return null;const value=propValue||defaultOpenValue,disabledOptions=disabledSeconds((0,getHours.q)(value),(0,getMinutes.O)(value));return(0,jsx_runtime.jsx)(src_Select,{prefixCls,options:secondOptions.map((option=>formatOption(option,disabledOptions))),selectedIndex:secondOptions.indexOf(second),type:"second",label:"second",onSelect:onItemChange,onKeyDown:e=>handleKeyDown("second",e),focused:"second"===selectFocusOn})})((0,getSeconds.S)(value)),(()=>{const{prefixCls,use12Hours,format,isAM}=props;if(!use12Hours)return null;const AMPMOptions=["am","pm"].map((c=>format.match(/\sA/)?c.toUpperCase():c)).map((c=>({value:c,disabled:!1}))),selected=isAM?0:1;return(0,jsx_runtime.jsx)(src_Select,{prefixCls,options:AMPMOptions,selectedIndex:selected,type:"ampm",label:"AM or PM",onSelect:onItemChange,onKeyDown:e=>handleKeyDown("ampm",e),focused:"ampm"===selectFocusOn})})()]})};function Panel({prefixCls,defaultOpenValue=new Date,value,format,disabledHours=noopDisabled,disabledMinutes=noopDisabled,disabledSeconds=noopDisabled,hideDisabledOptions,onChange=noop,onAmPmChange=noop,closePanel,showHour,showMinute,showSecond,use12Hours=!1,hourStep,minuteStep,secondStep}){const[internalValue,setInternalValue]=(0,react.useState)(value);(0,react.useEffect)((()=>{value&&setInternalValue(value)}),[value]);const handleChange=(0,react.useCallback)((newValue=>{setInternalValue(newValue),onChange(newValue)}),[onChange]),handleAmPmChange=(0,react.useCallback)((ampm=>{onAmPmChange(ampm)}),[onAmPmChange]),isAM=(0,react.useCallback)((()=>{const realValue=internalValue||defaultOpenValue,hours=(0,getHours.q)(realValue);return hours>=0&&hours<12}),[internalValue,defaultOpenValue]),getDisabledHours=(0,react.useCallback)((()=>{let disabledOptions=disabledHours();return use12Hours&&Array.isArray(disabledOptions)&&(disabledOptions=isAM()?disabledOptions.filter((h=>h<12)).map((h=>0===h?12:h)):disabledOptions.map((h=>12===h?12:h-12))),disabledOptions}),[use12Hours,disabledHours,isAM]),disabledHourOptions=getDisabledHours(),disabledMinuteOptions=disabledMinutes(internalValue?(0,getHours.q)(internalValue):null),disabledSecondOptions=disabledSeconds(internalValue?(0,getHours.q)(internalValue):null,internalValue?(0,getMinutes.O)(internalValue):null),hourOptions=generateOptions(24,disabledHourOptions,hideDisabledOptions,hourStep),minuteOptions=generateOptions(60,disabledMinuteOptions,hideDisabledOptions,minuteStep),secondOptions=generateOptions(60,disabledSecondOptions,hideDisabledOptions,secondStep),validDefaultOpenValue=function toNearestValidTime(time,hourOptions,minuteOptions,secondOptions){const hour=hourOptions.slice().sort(((a,b)=>Math.abs((0,getHours.q)(time)-a)-Math.abs((0,getHours.q)(time)-b)))[0],minute=minuteOptions.slice().sort(((a,b)=>Math.abs((0,getMinutes.O)(time)-a)-Math.abs((0,getMinutes.O)(time)-b)))[0],second=secondOptions.slice().sort(((a,b)=>Math.abs((0,getSeconds.S)(time)-a)-Math.abs((0,getSeconds.S)(time)-b)))[0];return(0,parse.qg)(`${hour}:${minute}:${second}`,"HH:mm:ss",new Date)}(defaultOpenValue,hourOptions,minuteOptions,secondOptions);return(0,jsx_runtime.jsx)(focus_trap_react.FocusTrap,{focusTrapOptions:{initialFocus:`.${prefixCls}-select-option-selected`,onDeactivate:()=>closePanel(),clickOutsideDeactivates:!0,escapeDeactivates:!0},children:(0,jsx_runtime.jsx)("div",{className:`${prefixCls}-inner`,children:(0,jsx_runtime.jsx)(src_Combobox,{prefixCls,value:internalValue,defaultOpenValue:validDefaultOpenValue,format,onChange:handleChange,onAmPmChange:handleAmPmChange,showHour,showMinute,showSecond,hourOptions,minuteOptions,secondOptions,disabledHours:getDisabledHours,disabledMinutes,disabledSeconds,use12Hours,isAM:isAM()})})})}const src_Panel=react.forwardRef(Panel),defaultProps={id:"",disabled:!1,prefixCls:"react-samay",defaultOpen:!1,className:"",inputClassName:"",placeholder:"",defaultOpenValue:new Date,use12Hours:!1,showHour:!0,showMinute:!0,showSecond:!0,hourStep:1,minuteStep:1,secondStep:1,disabledHours:noopDisabled,disabledMinutes:noopDisabled,disabledSeconds:noopDisabled,hideDisabledOptions:!1,onChange:noop,onAmPmChange:noop,onOpen:noop,onClose:noop,onFocus:noop,onBlur:noop,getAriaLabel:()=>"react-samay-input-time"};const src_TimePicker=function TimePicker(props){const{id,name,disabled,placeholder,style,prefixCls,className,inputClassName,getAriaLabel,disabledHours,disabledMinutes,disabledSeconds,hideDisabledOptions,showHour,showMinute,showSecond,defaultOpenValue,use12Hours,onFocus,onBlur,hourStep,minuteStep,secondStep,format,onChange,onOpen,onClose,onAmPmChange}={...defaultProps,...props},controlledValue=props.value,controlledOpen=props.open,[value,setValue]=(0,react.useState)(props.defaultValue??new Date),[open,setOpen]=(0,react.useState)(props.defaultOpen??!1),inputRef=(0,react.useRef)(null),panelRef=(0,react.useRef)(null);(0,react.useEffect)((()=>{void 0!==controlledValue&&setValue(controlledValue)}),[controlledValue]),(0,react.useEffect)((()=>{void 0!==controlledOpen&&setOpen(controlledOpen)}),[controlledOpen]);const setOpenInternal=o=>{open!==o&&(void 0===controlledOpen&&setOpen(o),o?onOpen&&onOpen({open:!0}):onClose&&onClose({open:!1}))},getFormat=(includeAMPM=!0)=>{if(format)return format;if(use12Hours){const fmtString=[showHour?"h":"",showMinute?"mm":"",showSecond?"ss":""].filter(Boolean).join(":");return includeAMPM?fmtString.concat(" a"):fmtString}return[showHour?"HH":"",showMinute?"mm":"",showSecond?"ss":""].filter(Boolean).join(":")},strValue=value?(0,lightFormat.AD)(value,getFormat(use12Hours)):"";return(0,jsx_runtime.jsxs)("div",{id,style,className:classnames_default()(`${prefixCls}-wrapper`,className),children:[(0,jsx_runtime.jsx)("input",{type:"text",name,className:classnames_default()(`${prefixCls}-input`,inputClassName),ref:inputRef,placeholder,disabled,"aria-label":getAriaLabel?getAriaLabel(strValue):"",value:strValue,onChange:noop,onFocus,onBlur,onClick:()=>setOpenInternal(!0),onKeyDown:e=>{[8,13,32,40].indexOf(e.keyCode)>=0&&setOpenInternal(!0)}}),open&&(0,jsx_runtime.jsx)(src_Panel,{prefixCls:`${prefixCls}-panel`,ref:panelRef,value,defaultOpenValue,showHour,showMinute,showSecond,closePanel:()=>{setOpenInternal(!1),inputRef.current?.focus()},format:getFormat(),disabledHours,disabledMinutes,disabledSeconds,hideDisabledOptions,use12Hours,hourStep,minuteStep,secondStep,onChange:val=>(val=>{void 0===controlledValue&&setValue(val),onChange&&onChange(val)})(val),onAmPmChange:ampm=>onAmPmChange&&onAmPmChange(ampm)})]})}}}]);